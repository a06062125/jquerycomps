(function(){var b=window.Aes={};b.cipher=function(h,d){var g=4;var l=d.length/g-1;var k=[[],[],[],[]];for(var j=0;j<4*g;j++){k[j%4][Math.floor(j/4)]=h[j]}k=b.addRoundKey(k,d,0,g);for(var f=1;f<l;f++){k=b.subBytes(k,g);k=b.shiftRows(k,g);k=b.mixColumns(k,g);k=b.addRoundKey(k,d,f,g)}k=b.subBytes(k,g);k=b.shiftRows(k,g);k=b.addRoundKey(k,d,l,g);var e=new Array(4*g);for(var j=0;j<4*g;j++){e[j]=k[j%4][Math.floor(j/4)]}return e};b.keyExpansion=function(j){var g=4;var e=j.length/4;var k=e+6;var h=new Array(g*(k+1));var l=new Array(4);for(var f=0;f<e;f++){var d=[j[4*f],j[4*f+1],j[4*f+2],j[4*f+3]];h[f]=d}for(var f=e;f<(g*(k+1));f++){h[f]=new Array(4);for(var m=0;m<4;m++){l[m]=h[f-1][m]}if(f%e==0){l=b.subWord(b.rotWord(l));for(var m=0;m<4;m++){l[m]^=b.rCon[f/e][m]}}else{if(e>6&&f%e==4){l=b.subWord(l)}}for(var m=0;m<4;m++){h[f][m]=h[f-e][m]^l[m]}}return h};b.subBytes=function(e,d){for(var f=0;f<4;f++){for(var g=0;g<d;g++){e[f][g]=b.sBox[e[f][g]]}}return e};b.shiftRows=function(f,d){var e=new Array(4);for(var g=1;g<4;g++){for(var h=0;h<4;h++){e[h]=f[g][(h+g)%d]}for(var h=0;h<4;h++){f[g][h]=e[h]}}return f};b.mixColumns=function(h,f){for(var j=0;j<4;j++){var e=new Array(4);var d=new Array(4);for(var g=0;g<4;g++){e[g]=h[g][j];d[g]=h[g][j]&128?h[g][j]<<1^283:h[g][j]<<1}h[0][j]=d[0]^e[1]^d[1]^e[2]^e[3];h[1][j]=e[0]^d[1]^e[2]^d[2]^e[3];h[2][j]=e[0]^e[1]^d[2]^e[3]^d[3];h[3][j]=e[0]^d[0]^e[1]^e[2]^d[3]}return h};b.addRoundKey=function(h,d,f,e){for(var g=0;g<4;g++){for(var i=0;i<e;i++){h[g][i]^=d[f*4+i][g]}}return h};b.subWord=function(d){for(var e=0;e<4;e++){d[e]=b.sBox[d[e]]}return d};b.rotWord=function(d){var f=d[0];for(var e=0;e<3;e++){d[e]=d[e+1]}d[3]=f;return d};b.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];b.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];b.Ctr={};b.Ctr.encrypt=function(k,d,v){var l=16;if(!(v==128||v==192||v==256)){return""}k=a.encode(k);d=a.encode(d);var m=v/8;var g=new Array(m);for(var t=0;t<m;t++){g[t]=isNaN(d.charCodeAt(t))?0:d.charCodeAt(t)}var A=b.cipher(g,b.keyExpansion(g));A=A.concat(A.slice(0,m-16));var f=new Array(l);var u=(new Date()).getTime();var h=u%1000;var e=Math.floor(u/1000);var q=Math.floor(Math.random()*65535);for(var t=0;t<2;t++){f[t]=(h>>>t*8)&255}for(var t=0;t<2;t++){f[t+2]=(q>>>t*8)&255}for(var t=0;t<4;t++){f[t+4]=(e>>>t*8)&255}var o="";for(var t=0;t<8;t++){o+=String.fromCharCode(f[t])}var x=b.keyExpansion(A);var s=Math.ceil(k.length/l);var n=new Array(s);for(var y=0;y<s;y++){for(var w=0;w<4;w++){f[15-w]=(y>>>w*8)&255}for(var w=0;w<4;w++){f[15-w-4]=(y/4294967296>>>w*8)}var j=b.cipher(f,x);var r=y<s-1?l:(k.length-1)%l+1;var p=new Array(r);for(var t=0;t<r;t++){p[t]=j[t]^k.charCodeAt(y*l+t);p[t]=String.fromCharCode(p[t])}n[y]=p.join("")}var z=o+n.join("");z=c.encode(z);return z};b.Ctr.decrypt=function(u,f,q){var n=16;if(!(q==128||q==192||q==256)){return""}u=c.decode(u);f=a.encode(f);var o=q/8;var k=new Array(o);for(var p=0;p<o;p++){k[p]=isNaN(f.charCodeAt(p))?0:f.charCodeAt(p)}var v=b.cipher(k,b.keyExpansion(k));v=v.concat(v.slice(0,o-16));var g=new Array(8);ctrTxt=u.slice(0,8);for(var p=0;p<8;p++){g[p]=ctrTxt.charCodeAt(p)}var s=b.keyExpansion(v);var h=Math.ceil((u.length-8)/n);var j=new Array(h);for(var t=0;t<h;t++){j[t]=u.slice(8+t*n,8+t*n+n)}u=j;var d=new Array(u.length);for(var t=0;t<h;t++){for(var r=0;r<4;r++){g[15-r]=((t)>>>r*8)&255}for(var r=0;r<4;r++){g[15-r-4]=(((t+1)/4294967296-1)>>>r*8)&255}var m=b.cipher(g,s);var e=new Array(u[t].length);for(var p=0;p<u[t].length;p++){e[p]=m[p]^u[t].charCodeAt(p);e[p]=String.fromCharCode(e[p])}d[t]=e.join("")}var l=d.join("");l=a.decode(l);return l};var c={};c.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c.encode=function(p,r){r=(typeof r=="undefined")?false:r;var i,f,d,t,q,m,l,j,k=[],h="",o,s,n;var g=c.code;s=r?p.encodeUTF8():p;o=s.length%3;if(o>0){while(o++<3){h+="=";s+="\0"}}for(o=0;o<s.length;o+=3){i=s.charCodeAt(o);f=s.charCodeAt(o+1);d=s.charCodeAt(o+2);t=i<<16|f<<8|d;q=t>>18&63;m=t>>12&63;l=t>>6&63;j=t&63;k[o/3]=g.charAt(q)+g.charAt(m)+g.charAt(l)+g.charAt(j)}n=k.join("");n=n.slice(0,n.length-h.length)+h;return n};c.decode=function(p,g){g=(typeof g=="undefined")?false:g;var i,f,e,q,m,k,j,s,l=[],r,o;var h=c.code;o=g?p.decodeUTF8():p;for(var n=0;n<o.length;n+=4){q=h.indexOf(o.charAt(n));m=h.indexOf(o.charAt(n+1));k=h.indexOf(o.charAt(n+2));j=h.indexOf(o.charAt(n+3));s=q<<18|m<<12|k<<6|j;i=s>>>16&255;f=s>>>8&255;e=s&255;l[n/4]=String.fromCharCode(i,f,e);if(j==64){l[n/4]=String.fromCharCode(i,f)}if(k==64){l[n/4]=String.fromCharCode(i)}}r=l.join("");return g?r.decodeUTF8():r};var a={};a.encode=function(d){var e=d.replace(/[\u0080-\u07ff]/g,function(g){var f=g.charCodeAt(0);return String.fromCharCode(192|f>>6,128|f&63)});e=e.replace(/[\u0800-\uffff]/g,function(g){var f=g.charCodeAt(0);return String.fromCharCode(224|f>>12,128|f>>6&63,128|f&63)});return e};a.decode=function(e){var d=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(g){var f=((g.charCodeAt(0)&15)<<12)|((g.charCodeAt(1)&63)<<6)|(g.charCodeAt(2)&63);return String.fromCharCode(f)});d=d.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(g){var f=(g.charCodeAt(0)&31)<<6|g.charCodeAt(1)&63;return String.fromCharCode(f)});return d}}());