(function(){var d=window.Aes={};d.cipher=function(i,p){var m=4;var a=p.length/m-1;var b=[[],[],[],[]];for(var c=0;c<4*m;c++){b[c%4][Math.floor(c/4)]=i[c]}b=d.addRoundKey(b,p,0,m);for(var n=1;n<a;n++){b=d.subBytes(b,m);b=d.shiftRows(b,m);b=d.mixColumns(b,m);b=d.addRoundKey(b,p,n,m)}b=d.subBytes(b,m);b=d.shiftRows(b,m);b=d.addRoundKey(b,p,a,m);var o=new Array(4*m);for(var c=0;c<4*m;c++){o[c]=b[c%4][Math.floor(c/4)]}return o};d.keyExpansion=function(i){var o=4;var q=i.length/4;var c=q+6;var n=new Array(o*(c+1));var b=new Array(4);for(var p=0;p<q;p++){var r=[i[4*p],i[4*p+1],i[4*p+2],i[4*p+3]];n[p]=r}for(var p=q;p<(o*(c+1));p++){n[p]=new Array(4);for(var a=0;a<4;a++){b[a]=n[p-1][a]}if(p%q==0){b=d.subWord(d.rotWord(b));for(var a=0;a<4;a++){b[a]^=d.rCon[p/q][a]}}else{if(q>6&&p%q==4){b=d.subWord(b)}}for(var a=0;a<4;a++){n[p][a]=n[p-q][a]^b[a]}}return n};d.subBytes=function(c,h){for(var b=0;b<4;b++){for(var a=0;a<h;a++){c[b][a]=d.sBox[c[b][a]]}}return c};d.shiftRows=function(c,j){var i=new Array(4);for(var b=1;b<4;b++){for(var a=0;a<4;a++){i[a]=c[b][(a+b)%j]}for(var a=0;a<4;a++){c[b][a]=i[a]}}return c};d.mixColumns=function(b,i){for(var a=0;a<4;a++){var k=new Array(4);var l=new Array(4);for(var c=0;c<4;c++){k[c]=b[c][a];l[c]=b[c][a]&128?b[c][a]<<1^283:b[c][a]<<1}b[0][a]=l[0]^k[1]^l[1]^k[2]^k[3];b[1][a]=k[0]^l[1]^k[2]^l[2]^k[3];b[2][a]=k[0]^k[1]^l[2]^k[3]^l[3];b[3][a]=k[0]^l[0]^k[1]^k[2]^l[3]}return b};d.addRoundKey=function(b,l,j,k){for(var c=0;c<4;c++){for(var a=0;a<k;a++){b[c][a]^=l[j*4+a][c]}}return b};d.subWord=function(b){for(var a=0;a<4;a++){b[a]=d.sBox[b[a]]}return b};d.rotWord=function(c){var a=c[0];for(var b=0;b<3;b++){c[b]=c[b+1]}c[3]=a;return c};d.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];d.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];d.Ctr={};d.Ctr.encrypt=function(N,T,B){var M=16;if(!(B==128||B==192||B==256)){return""}N=e.encode(N);T=e.encode(T);var L=B/8;var Q=new Array(L);for(var D=0;D<L;D++){Q[D]=isNaN(T.charCodeAt(D))?0:T.charCodeAt(D)}var I=d.cipher(Q,d.keyExpansion(Q));I=I.concat(I.slice(0,L-16));var R=new Array(M);var C=(new Date()).getTime();var P=C%1000;var S=Math.floor(C/1000);var G=Math.floor(Math.random()*65535);for(var D=0;D<2;D++){R[D]=(P>>>D*8)&255}for(var D=0;D<2;D++){R[D+2]=(G>>>D*8)&255}for(var D=0;D<4;D++){R[D+4]=(S>>>D*8)&255}var J="";for(var D=0;D<8;D++){J+=String.fromCharCode(R[D])}var c=d.keyExpansion(I);var E=Math.ceil(N.length/M);var K=new Array(E);for(var b=0;b<E;b++){for(var i=0;i<4;i++){R[15-i]=(b>>>i*8)&255}for(var i=0;i<4;i++){R[15-i-4]=(b/4294967296>>>i*8)}var O=d.cipher(R,c);var F=b<E-1?M:(N.length-1)%M+1;var H=new Array(F);for(var D=0;D<F;D++){H[D]=O[D]^N.charCodeAt(b*M+D);H[D]=String.fromCharCode(H[D])}K[b]=H.join("")}var a=J+K.join("");a=f.encode(a);return a};d.Ctr.decrypt=function(b,H,x){var A=16;if(!(x==128||x==192||x==256)){return""}b=f.decode(b);H=e.encode(H);var z=x/8;var D=new Array(z);for(var y=0;y<z;y++){D[y]=isNaN(H.charCodeAt(y))?0:H.charCodeAt(y)}var a=d.cipher(D,d.keyExpansion(D));a=a.concat(a.slice(0,z-16));var G=new Array(8);ctrTxt=b.slice(0,8);for(var y=0;y<8;y++){G[y]=ctrTxt.charCodeAt(y)}var i=d.keyExpansion(a);var F=Math.ceil((b.length-8)/A);var E=new Array(F);for(var c=0;c<F;c++){E[c]=b.slice(8+c*A,8+c*A+A)}b=E;var J=new Array(b.length);for(var c=0;c<F;c++){for(var w=0;w<4;w++){G[15-w]=((c)>>>w*8)&255}for(var w=0;w<4;w++){G[15-w-4]=(((c+1)/4294967296-1)>>>w*8)&255}var B=d.cipher(G,i);var I=new Array(b[c].length);for(var y=0;y<b[c].length;y++){I[y]=B[y]^b[c].charCodeAt(y);I[y]=String.fromCharCode(I[y])}J[c]=I.join("")}var C=J.join("");C=e.decode(C);return C};var f={};f.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(c,a){a=(typeof a=="undefined")?false:a;var A,D,E,F,b,w,x,z,y=[],B="",u,G,v;var C=f.code;G=a?c.encodeUTF8():c;u=G.length%3;if(u>0){while(u++<3){B+="=";G+="\0"}}for(u=0;u<G.length;u+=3){A=G.charCodeAt(u);D=G.charCodeAt(u+1);E=G.charCodeAt(u+2);F=A<<16|D<<8|E;b=F>>18&63;w=F>>12&63;x=F>>6&63;z=F&63;y[u/3]=C.charAt(b)+C.charAt(w)+C.charAt(x)+C.charAt(z)}v=y.join("");v=v.slice(0,v.length-B.length)+B;return v};f.decode=function(c,B){B=(typeof B=="undefined")?false:B;var z,C,D,b,v,x,y,E,w=[],a,t;var A=f.code;t=B?c.decodeUTF8():c;for(var u=0;u<t.length;u+=4){b=A.indexOf(t.charAt(u));v=A.indexOf(t.charAt(u+1));x=A.indexOf(t.charAt(u+2));y=A.indexOf(t.charAt(u+3));E=b<<18|v<<12|x<<6|y;z=E>>>16&255;C=E>>>8&255;D=E&255;w[u/4]=String.fromCharCode(z,C,D);if(y==64){w[u/4]=String.fromCharCode(z,C)}if(x==64){w[u/4]=String.fromCharCode(z)}}a=w.join("");return B?a.decodeUTF8():a};var e={};e.encode=function(b){var a=b.replace(/[\u0080-\u07ff]/g,function(c){var h=c.charCodeAt(0);return String.fromCharCode(192|h>>6,128|h&63)});a=a.replace(/[\u0800-\uffff]/g,function(c){var h=c.charCodeAt(0);return String.fromCharCode(224|h>>12,128|h>>6&63,128|h&63)});return a};e.decode=function(a){var b=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(c){var h=((c.charCodeAt(0)&15)<<12)|((c.charCodeAt(1)&63)<<6)|(c.charCodeAt(2)&63);return String.fromCharCode(h)});b=b.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(c){var h=(c.charCodeAt(0)&31)<<6|c.charCodeAt(1)&63;return String.fromCharCode(h)});return b}}());