(function(f){window.Bizs.DisableLogic=g;function g(a){if(g.getInstance(a)){return g.getInstance(a)}g.getInstance(a,this);JC.log("Bizs.DisableLogic:",new Date().getTime());this._model=new h(a);this._view=new e(this._model);this._init()}g.prototype={_init:function(){var b=this,a;b._initHandlerEvent();f([b._view,b._model]).on("BindEvent",function(j,c,d){b.on(c,d)});f([b._view,b._model]).on("TriggerEvent",function(j,c){var d=sliceArgs(arguments).slice(2);b.trigger(c,d)});b._model.init();b._view.init();b._model.dltrigger().on("change",function(c){JC.log("dltrigger change",new Date().getTime());b._view.change(this)});(a=b._model.dltrigger(true))&&a.trigger("change");return b},_initHandlerEvent:function(){var a=this;a.on("DisableItem",function(b,c){a._model.dldisablecallback()&&a._model.dldisablecallback().call(a,c,a._model.selector())});a.on("EnableItem",function(b,c){a._model.dlenablecallback()&&a._model.dlenablecallback().call(a,c,a._model.selector())});a.on("ChangeDone",function(b,c){a._model.dldonecallback()&&a._model.dldonecallback().call(a,c,a._model.selector())})},selector:function(){return this._model.selector()},on:function(a,b){f(this).on(a,b);return this},trigger:function(a,b){f(this).trigger(a,b);return this}};g.getInstance=function(b,a){if(typeof b=="string"&&!/</.test(b)){b=f(b)}if(!(b&&b.length)||(typeof b=="string")){return}typeof a!="undefined"&&b.data("DisableLogicIns",a);return b.data("DisableLogicIns")};g.doneCallback=null;g.enableCallback=null;g.disableCallback=null;g.init=function(a){a=f(a||document);a.find(["div.js_bizsDisableLogic","dl.js_bizsDisableLogic","table.js_bizsDisableLogic"].join()).each(function(){new g(f(this))})};function h(a){this._selector=a}h.prototype={init:function(){return this},selector:function(){return this._selector},dltrigger:function(c){var d=this,a=parentSelector(this.selector(),this.selector().attr("dltrigger")),b;if(c){a.each(function(){b=f(this);if(b.prop("checked")||b.prop("selected")){a=b;return false}})}return a},dltarget:function(c){var d=this,a,b;d.selector().attr("dltarget")&&(a=parentSelector(d.selector(),d.selector().attr("dltarget")));c&&(c=f(c)).length&&c.attr("dltrigger")&&(a=parentSelector(c,c.attr("dltarget")));return a},dldisable:function(b){var a=false;b&&(b=f(b)).length&&b.is("[dldisable]")&&(a=parseBool(b.attr("dldisable")));if(b.prop("nodeName").toLowerCase()=="input"&&b.attr("type").toLowerCase()=="checkbox"){a=!b.prop("checked")}return a},dldisplay:function(b){var a=false;if(!b.is("[dldisplay]")){(b=f(b)).length&&b.is("[dldisable]")&&(a=!parseBool(b.attr("dldisable")))}else{(b=f(b)).length&&b.is("[dldisplay]")&&(a=parseBool(b.attr("dldisplay")))}if(b.prop("nodeName").toLowerCase()=="input"&&b.attr("type").toLowerCase()=="checkbox"){a=b.prop("checked")}return a},dlhidetarget:function(c){var d=this,a,b;d.selector().attr("dlhidetarget")&&(a=parentSelector(d.selector(),d.selector().attr("dlhidetarget")));c&&(c=f(c)).length&&c.attr("dlhidetarget")&&(a=parentSelector(c,c.attr("dlhidetarget")));return a},dlhidetoggle:function(b){var a;b&&b.is("[dlhidetoggle]")&&(a=parseBool(b.attr("dlhidetoggle")));return a},dldonecallback:function(){var a=g.doneCallback,b;this.selector()&&(b=this.selector().attr("dldonecallback"))&&(b=window[b])&&(a=b);return a},dlenablecallback:function(){var a=g.enableCallback,b;this.selector()&&(b=this.selector().attr("dlenablecallback"))&&(b=window[b])&&(a=b);return a},dldisablecallback:function(){var a=g.disableCallback,b;this.selector()&&(b=this.selector().attr("dldisablecallback"))&&(b=window[b])&&(a=b);return a}};function e(a){this._model=a}e.prototype={init:function(){return this},change:function(k){k&&(k=f(k));if(!(k&&k.length)){return}var l=this,c=l._model.dldisable(k),a=l._model.dltarget(k),b=l._model.dldisplay(k),d=l._model.dlhidetarget(k);a&&a.length&&a.each(function(){f(this).attr("disabled",c);JC.Valid&&JC.Valid.setValid(f(this))});if(d&&d.length){d.each(function(){var i=l._model.dlhidetoggle(f(this))?!b:b;i?f(this).show():f(this).hide()})}c?f(l).trigger("TriggerEvent",["DisableItem",k]):f(l).trigger("TriggerEvent",["EnableItem",k]);f(l).trigger("TriggerEvent",["ChangeDone",k]);JC.log("DisableLogic view change",new Date().getTime(),c)}};f(document).ready(function(){setTimeout(function(){g.init()},10)})}(jQuery));