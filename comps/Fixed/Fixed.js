(function(b){window.Fixed=JC.Fixed=a;function a(e){if(a.getInstance(e)){return a.getInstance(e)}a.getInstance(e,this);this._model=new d(e);this._view=new c(this._model);this._init()}a.prototype={_init:function(){b([this._view,this._model]).on("BindEvent",function(e,g,f){_p.on(g,f)});b([this._view,this._model]).on("TriggerEvent",function(e,g){var f=sliceArgs(arguments);f.shift();f.shift();_p.trigger(g,f)});this._model.init();this._view.init();JC.log("Fixed init:",new Date().getTime());return this},show:function(){this._view.show();return this},hide:function(){this._view.hide();return this},layout:function(){return this._model.layout()},on:function(f,e){b(this).on(f,e);return this},trigger:function(f,e){b(this).trigger(f,e);return this}};a.getInstance=function(e,f){if(typeof e=="string"&&!/</.test(e)){e=b(e)}if(!(e&&e.length)||(typeof e=="string")){return}typeof f!="undefined"&&e.data("FixedIns",f);return e.data("FixedIns")};a.autoInit=true;a.durationms=300;a.stepms=3;a.interval=function(e){a._interval&&clearInterval(a._interval);e&&(a._interval=e)};function d(e){this._layout=e}d.prototype={init:function(){return this},isFixedTop:function(){return this._layout.is("[fixedtop]")},isFixedRight:function(){return this._layout.is("[fixedright]")},isFixedBottom:function(){return this._layout.is("[fixedbottom]")},isFixedLeft:function(){return this._layout.is("[fixedleft]")},isFixedCenter:function(){return this._layout.is("[fixedcenter]")},fixedtop:function(){return parseInt(this._layout.attr("fixedtop"),10)},fixedright:function(){return parseInt(this._layout.attr("fixedright"),10)},fixedbottom:function(){return parseInt(this._layout.attr("fixedbottom"),10)},fixedleft:function(){return parseInt(this._layout.attr("fixedleft"),10)},fixedcenter:function(){var e=(this._layout.attr("fixedcenter")||"").replace(/[^\d.,\-]/g,"").split(",");e.length<2&&e.push("0");e[0]=parseInt(e[0],10)||0;e[1]=parseInt(e[1],10)||0;return e},fixeddurationms:function(e){var f;this.layout().is("[fixeddurationms]")&&(f=parseInt(this.layout().attr("fixeddurationms")));e.is("[fixeddurationms]")&&(f=parseInt(e.attr("fixeddurationms")));typeof f=="undefined"&&(f=a.durationms);isNaN(f)&&(f=a.durationms);return f},fixedstepms:function(e){var f;this.layout().is("[fixedstepms]")&&(f=parseInt(this.layout().attr("fixedstepms")));e.is("[fixedstepms]")&&(f=parseInt(e.attr("fixedstepms")));typeof f=="undefined"&&(f=a.stepms);isNaN(f)&&(f=a.stepms);return f},fixedmoveto:function(e){var f="";e&&(e=b(e))&&e.length&&(f=e.attr("fixedmoveto")||"");return f.trim()},moveToItem:function(){var f=this.layout().is("[fixedmoveto]")?this.layout():null,e;if(!f){(e=this._layout.find("[fixedmoveto]")).length&&(f=e)}return f},layout:function(){return this._layout},fixedeffect:function(f){var g=true,e=this;e.layout().is("[fixedeffect]")&&(g=parseBool(e.layout().attr("fixedeffect")));f&&f.is("[fixedeffect]")&&(g=parseBool(f.attr("fixedeffect")));return g}};function c(e){this._model=e}c.prototype={init:function(){var e=this;b.support.isFixed?(this._initFixedSupport(),b(window).on("resize",function(){e._updateFixedSupport()})):this._initFixedUnsupport();this._initMoveTo();this._model.layout().show();return this},_initMoveTo:function(){var f=this,g=f._model.moveToItem();if(!(g&&g.length)){return}g.on("click",function(j){var i=b(this),h=f._model.fixedmoveto(i).toLowerCase();f._processMoveto(h,i)});b(window).on("resize",function(){a.interval()});mousewheelEvent(function e(h){a.interval()})},_processMoveto:function(n,j){if(!n){return}var g=this,l=parseInt(n,10),h=b(document).height(),q=h-b(window).height(),k=b(document).scrollTop(),o=k,e=0,p,f,i,m;if(isNaN(l)){switch(n){case"top":l=0;break;case"bottom":l=q;break;default:m=b(n);if(m.length){l=m.offset().top}break}}(isNaN(l)||l<0)&&(l=0);l>q&&(l=q);if(k==l){return}p=l<k?true:false;f=k>l?k:l;i=k>l?l:k;if(!g._model.fixedeffect(j)){b(document).scrollTop(l);return}a.interval(easyEffect(function(s,r){p&&(s=f-s+i);b(document).scrollTop(s)},f,i,g._model.fixeddurationms(j),g._model.fixedstepms(j)))},_initFixedSupport:function(){var f=this,e=f._model.layout().width(),j=f._model.layout().height(),h=b(window).width(),i=b(window).height(),g;if(f._model.isFixedCenter()){f._updateFixedSupport()}else{f._model.isFixedTop()&&f._model.layout().css("top",f._model.fixedtop()+"px");f._model.isFixedRight()&&f._model.layout().css("right",f._model.fixedright()+"px");f._model.isFixedBottom()&&f._model.layout().css("bottom",f._model.fixedbottom()+"px");f._model.isFixedLeft()&&f._model.layout().css("left",f._model.fixedleft()+"px")}f._model.layout().css("position","fixed")},_updateFixedSupport:function(){var f=this,m,l,g=b(document).scrollLeft(),h=f._model.layout().width(),j=f._model.layout().height(),e=b(window).width(),i=b(window).height(),k;if(f._model.isFixedCenter()){k=f._model.fixedcenter();m=e/2-h/2+k[0];l=i/2-j/2+k[1];f._model.layout().css("left",m+"px");f._model.layout().css("top",l+"px")}},_initFixedUnsupport:function(){var e=this;e._model.layout().css("position","absolute");e._updateFixedUnsupport();b(window).on("scroll resize",function(){e._updateFixedUnsupport()})},_updateFixedUnsupport:function(){var g=this,n,e,m,o,h=b(document).scrollTop(),i=b(document).scrollLeft(),j=g._model.layout().width(),l=g._model.layout().height(),f=b(window).width(),k=b(window).height();if(g._model.isFixedTop()){n=g._model.fixedtop()+h;g._model.layout().css("top",n+"px")}if(g._model.isFixedRight()){e=f-g._model.fixedright()-j+i;g._model.layout().css("left",e+"px")}if(g._model.isFixedBottom()){m=h+k-g._model.fixedbottom()-l;g._model.layout().css("top",m+"px")}if(g._model.isFixedLeft()){o=i+g._model.fixedleft();g._model.layout().css("left",o+"px")}},hide:function(){},show:function(){}};b(document).ready(function(){if(!a.autoInit){return}b(["div.js_autoFixed","dl.js_autoFixed","ul.js_autoFixed","ol.js_autoFixed","button.js_autoFixed"].join()).each(function(){new a(b(this))})})}(jQuery));