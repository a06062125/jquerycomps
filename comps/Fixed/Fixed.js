(function(e){window.Fixed=JC.Fixed=f;function f(a){if(f.getInstance(a)){return f.getInstance(a)}f.getInstance(a,this);this._model=new g(a);this._view=new h(this._model);this._init()}f.prototype={_init:function(){e([this._view,this._model]).on("BindEvent",function(c,a,b){_p.on(a,b)});e([this._view,this._model]).on("TriggerEvent",function(c,a){var b=sliceArgs(arguments);b.shift();b.shift();_p.trigger(a,b)});this._model.init();this._view.init();JC.log("Fixed init:",new Date().getTime());return this},show:function(){this._view.show();return this},hide:function(){this._view.hide();return this},layout:function(){return this._model.layout()},on:function(a,b){e(this).on(a,b);return this},trigger:function(a,b){e(this).trigger(a,b);return this}};f.getInstance=function(b,a){if(typeof b=="string"&&!/</.test(b)){b=e(b)}if(!(b&&b.length)||(typeof b=="string")){return}typeof a!="undefined"&&b.data("FixedIns",a);return b.data("FixedIns")};f.autoInit=true;f.durationms=300;f.stepms=3;f.interval=function(a){f._interval&&clearInterval(f._interval);a&&(f._interval=a)};function g(a){this._layout=a}g.prototype={init:function(){return this},isFixedTop:function(){return this._layout.is("[fixedtop]")},isFixedRight:function(){return this._layout.is("[fixedright]")},isFixedBottom:function(){return this._layout.is("[fixedbottom]")},isFixedLeft:function(){return this._layout.is("[fixedleft]")},isFixedCenter:function(){return this._layout.is("[fixedcenter]")},fixedtop:function(){return parseInt(this._layout.attr("fixedtop"),10)},fixedright:function(){return parseInt(this._layout.attr("fixedright"),10)},fixedbottom:function(){return parseInt(this._layout.attr("fixedbottom"),10)},fixedleft:function(){return parseInt(this._layout.attr("fixedleft"),10)},fixedcenter:function(){var a=(this._layout.attr("fixedcenter")||"").replace(/[^\d.,\-]/g,"").split(",");a.length<2&&a.push("0");a[0]=parseInt(a[0],10)||0;a[1]=parseInt(a[1],10)||0;return a},fixeddurationms:function(b){var a;this.layout().is("[fixeddurationms]")&&(a=parseInt(this.layout().attr("fixeddurationms")));b.is("[fixeddurationms]")&&(a=parseInt(b.attr("fixeddurationms")));typeof a=="undefined"&&(a=f.durationms);isNaN(a)&&(a=f.durationms);return a},fixedstepms:function(b){var a;this.layout().is("[fixedstepms]")&&(a=parseInt(this.layout().attr("fixedstepms")));b.is("[fixedstepms]")&&(a=parseInt(b.attr("fixedstepms")));typeof a=="undefined"&&(a=f.stepms);isNaN(a)&&(a=f.stepms);return a},fixedmoveto:function(b){var a="";b&&(b=e(b))&&b.length&&(a=b.attr("fixedmoveto")||"");return a.trim()},moveToItem:function(){var a=this.layout().is("[fixedmoveto]")?this.layout():null,b;if(!a){(b=this._layout.find("[fixedmoveto]")).length&&(a=b)}return a},layout:function(){return this._layout},fixedeffect:function(b){var a=true,c=this;c.layout().is("[fixedeffect]")&&(a=parseBool(c.layout().attr("fixedeffect")));b&&b.is("[fixedeffect]")&&(a=parseBool(b.attr("fixedeffect")));return a}};function h(a){this._model=a}h.prototype={init:function(){var a=this;e.support.isFixed?(this._initFixedSupport(),e(window).on("resize",function(){a._updateFixedSupport()})):this._initFixedUnsupport();this._initMoveTo();this._model.layout().show();return this},_initMoveTo:function(){var b=this,a=b._model.moveToItem();if(!(a&&a.length)){return}a.on("click",function(d){var k=e(this),l=b._model.fixedmoveto(k).toLowerCase();b._processMoveto(l,k)});e(window).on("resize",function(){f.interval()});mousewheelEvent(function c(d){f.interval()})},_processMoveto:function(d,u){if(!d){return}var x=this,s=parseInt(d,10),w=e(document).height(),a=w-e(window).height(),t=e(document).scrollTop(),c=t,z=0,b,y,v,r;if(isNaN(s)){switch(d){case"top":s=0;break;case"bottom":s=a;break;default:r=e(d);if(r.length){s=r.offset().top}break}}(isNaN(s)||s<0)&&(s=0);s>a&&(s=a);if(t==s){return}b=s<t?true:false;y=t>s?t:s;v=t>s?s:t;if(!x._model.fixedeffect(u)){e(document).scrollTop(s);return}f.interval(easyEffect(function(i,j){b&&(i=y-i+v);e(document).scrollTop(i)},y,v,x._model.fixeddurationms(u),x._model.fixedstepms(u)))},_initFixedSupport:function(){var k=this,l=k._model.layout().width(),a=k._model.layout().height(),c=e(window).width(),b=e(window).height(),d;if(k._model.isFixedCenter()){k._updateFixedSupport()}else{k._model.isFixedTop()&&k._model.layout().css("top",k._model.fixedtop()+"px");k._model.isFixedRight()&&k._model.layout().css("right",k._model.fixedright()+"px");k._model.isFixedBottom()&&k._model.layout().css("bottom",k._model.fixedbottom()+"px");k._model.isFixedLeft()&&k._model.layout().css("left",k._model.fixedleft()+"px")}k._model.layout().css("position","fixed")},_updateFixedSupport:function(){var q=this,a,b,p=e(document).scrollLeft(),o=q._model.layout().width(),d=q._model.layout().height(),r=e(window).width(),n=e(window).height(),c;if(q._model.isFixedCenter()){c=q._model.fixedcenter();a=r/2-o/2+c[0];b=n/2-d/2+c[1];q._model.layout().css("left",a+"px");q._model.layout().css("top",b+"px")}},_initFixedUnsupport:function(){var a=this;a._model.layout().css("position","absolute");a._updateFixedUnsupport();e(window).on("scroll resize",function(){a._updateFixedUnsupport()})},_updateFixedUnsupport:function(){var t=this,b,v,c,a,s=e(document).scrollTop(),r=e(document).scrollLeft(),q=t._model.layout().width(),d=t._model.layout().height(),u=e(window).width(),p=e(window).height();if(t._model.isFixedTop()){b=t._model.fixedtop()+s;t._model.layout().css("top",b+"px")}if(t._model.isFixedRight()){v=u-t._model.fixedright()-q+r;t._model.layout().css("left",v+"px")}if(t._model.isFixedBottom()){c=s+p-t._model.fixedbottom()-d;t._model.layout().css("top",c+"px")}if(t._model.isFixedLeft()){a=r+t._model.fixedleft();t._model.layout().css("left",a+"px")}},hide:function(){},show:function(){}};e(document).ready(function(){if(!f.autoInit){return}e(["div.js_autoFixed","dl.js_autoFixed","ul.js_autoFixed","ol.js_autoFixed","button.js_autoFixed"].join()).each(function(){new f(e(this))})})}(jQuery));