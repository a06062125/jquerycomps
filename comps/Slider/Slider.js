(function(d){window.Slider=JC.Slider=c;function c(f){f&&(f=d(f));if(c.getInstance(f)){return c.getInstance(f)}c.getInstance(f,this);JC.log("Slider constructor",new Date().getTime());this._model=new e(f);switch(this._model.direction()){case"vertical":this._view=new a(this._model,this);break;default:this._view=new b(this._model,this);break}this._init()}c.prototype={_init:function(){var f=this;f._initControl();f.on("cleartinterval",function(){f._model.clearInterval();f._view.setPagePosition()});f.on("cleartimeout",function(){f._model.clearTimeout()});f._initAutoMove();f._model.initedcb()&&f.on("inited",f._model.initedcb());f.trigger("inited");return this},on:function(g,f){d(this).on(g,f);return this},trigger:function(f){d(this).trigger(f);return this},move:function(f){this._view.move(f);return this},moveTo:function(f){this._view.moveTo(f);return this},totalpage:function(){return this._model.totalpage()},pointer:function(){return this._model.pointer()},page:function(f){return this._model.page(f)},layout:function(){return this._model.layout()},find:function(f){return this._model.layout().find(f)},_initControl:function(){switch(this._model.direction()){case"vertical":this._initVerticalControl();break;default:this._initHorizontalControl();break}},_initHorizontalControl:function(){var f=this;f._model.leftbutton()&&f._model.leftbutton().on("click",function(g){f.trigger("cleartimeout");f.trigger("movetoleft");f._view.move(1)}).on("mouseenter",function(){f.trigger("controlover")}).on("mouseleave",function(){f.trigger("controlout")});f._model.rightbutton()&&f._model.rightbutton().on("click",function(g){f.trigger("cleartimeout");f.trigger("movetoright");f._view.move()}).on("mouseenter",function(){f.trigger("controlover")}).on("mouseleave",function(){f.trigger("controlout")})},_initVerticalControl:function(){var f=this},_initAutoMove:function(){var f=this;if(!f._model.automove()){return}f.on("beforemove",function(g,i,h){f.trigger("cleartimeout")});f.on("movedone",function(g,i,h){if(f._model.controlover()){return}f.trigger("automove")});f._model.layout().on("mouseenter",function(g){f.trigger("cleartimeout");f.trigger("mouseenter")});f._model.layout().on("mouseleave",function(g){f.trigger("cleartimeout");f.trigger("mouseleave");f._view.setPagePosition();f.trigger("automove")});f.on("controlover",function(){f.trigger("cleartimeout");f._model.controlover(true)});f.on("controlout",function(){f.trigger("automove");f._model.controlover(false)});f.on("movetoleft",function(){f._model.moveDirection(false)});f.on("movetoright",function(){f._model.moveDirection(true)});d(f).on("automove",function(){f._model.timeout(setTimeout(function(){f._view.moveTo(f._model.automoveNewPointer())},f._model.automovems()))});f.trigger("automove");return this}};c.autoInit=true;c.init=function(g){var f=[];g&&(g=d(g));if(g&&g.length){if(c.isSlider(g)){if(c.getInstance(g)){return[c.getInstance(g)]}f.push(new c(g))}else{g.find("div.js_autoSlider, dl.js_autoSlider, ul.js_autoSlider, ol.js_autoSlider").each(function(){if(c.isSlider(this)){if(c.getInstance(d(this))){f.push(c.getInstance(d(this)));return}f.push(new c(d(this)))}})}}return f};c.getInstance=function(f,g){g&&f&&d(f).data("SliderIns",g);return f?d(f).data("SliderIns"):null};c.isSlider=function(f){f&&(f=d(f));return f&&(f.is("[sliderwidth]")||f.is("[sliderheight]"))};function e(f){this._layout=f;this._moveDirection=true;this._interval;this._timeout;this._init()}e.prototype={_init:function(){this.subitems();this.totalpage();JC.log(printf("w:{0}, h:{1}, iw:{2}, ih:{3}, dr:{4}, si:{6}, hi:{5}, totalpage:{7}",this.width(),this.height(),this.itemwidth(),this.itemheight(),this.direction(),this.howmanyitem(),this.subitems().length,this.totalpage()));return this},layout:function(){return this._layout},leftbutton:function(){return this._layout.is("[sliderleft]")?d(this._layout.attr("sliderleft")):null},rightbutton:function(){return this._layout.is("[sliderright]")?d(this._layout.attr("sliderright")):null},direction:function(){return this._layout.attr("sliderdirection").toLowerCase()||"horizontal"},moveDirection:function(f){typeof f!="undefined"&&(this._moveDirection=f);JC.log("moveDirection",this._moveDirection);return this._moveDirection},howmanyitem:function(){return parseInt(this._layout.attr("sliderhowmanyitem"),10)||1},width:function(){return parseInt(this._layout.attr("sliderwidth"),10)||800},height:function(){return parseInt(this._layout.attr("sliderheight"),10)||230},itemwidth:function(){return parseInt(this._layout.attr("slideritemwidth"),10)||160},itemheight:function(){return parseInt(this._layout.attr("slideritemheight"),10)||230},loop:function(){return parseBool(this._layout.attr("sliderloop"))},stepms:function(){return parseInt(this._layout.attr("sliderstepms"),10)||10},durationms:function(){return parseInt(this._layout.attr("sliderdurationms"),10)||300},automovems:function(){return parseInt(this._layout.attr("sliderautomovems"),10)||2000},automove:function(){return parseBool(this._layout.attr("sliderautomove"))},defaultpage:function(){return parseInt(this._layout.attr("sliderdefaultpage"),10)||0},subitems:function(){if(this._layout.is("[slidersubitems]")){this._subitems=this._layout.find(this._layout.attr("slidersubitems"))}else{this._subitems=this._layout.children()}return this._subitems},totalpage:function(){this.subitems();if(this.howmanyitem()>1){this._totalpage=Math.ceil(this._subitems.length/this.howmanyitem())}else{this._totalpage=this._subitems.length}return this._totalpage},page:function(j){this.subitems();!j&&(j=0);j<0&&(j=0);j>=this.totalpage()&&(j=this.totalpage()-1);j*=this.howmanyitem();var h=[];for(var f=j,g=0;g<this.howmanyitem()&&f<this._subitems.length;f++,g++){h.push(d(this._subitems[f]))}return h},pointer:function(f){if(typeof this._pointer=="undefined"){this._pointer=this.defaultpage()}if(typeof f!="undefined"){this._pointer=this.fixpointer(f)}return this._pointer},newpointer:function(f){var g=this.pointer();f&&g--;!f&&g++;g=this.fixpointer(g);return g},fixpointer:function(f){var g=f;if(this.loop()){g<0&&(g=this.totalpage()-1);g>=this.totalpage()&&(g=0)}else{g<0&&(g=0);g>=this.totalpage()&&(g=this.totalpage()-1)}return g},automoveNewPointer:function(){var f=this.pointer();if(this.moveDirection()){f++}else{f--}if(this.loop()){if(f>=this.totalpage()){f=0}else{if(f<0){f=this.totalpage()-1}}}else{if(f>=this.totalpage()){f=this.totalpage()-2;this.moveDirection(false)}else{if(f<0){f=1;this.moveDirection(true)}}}return f},interval:function(f){typeof f!="undefined"&&(this._interval=f);return this._interval},clearInterval:function(){this.interval()&&clearInterval(this.interval())},timeout:function(f){typeof f!="undefined"&&(this._timeout=f);return this._timeout},clearTimeout:function(){this.timeout()&&clearTimeout(this.timeout())},controlover:function(f){typeof f!="undefined"&&(this._controlover=f);return this._controlover},initedcb:function(){this._layout.is("[sliderinitedcb]")&&window[this._layout.attr("sliderinitedcb")]&&(this._initedcb=window[this._layout.attr("sliderinitedcb")]);return this._initedcb}};function b(f,g){this._model=f;this._slider=g;this._itemspace=(this._model.width()-Math.floor(this._model.width()/this._model.itemwidth())*this._model.itemwidth())/(this._model.totalpage()-1);this._itemspace=parseInt(this._itemspace);this._init()}b.prototype={_init:function(){this.setPagePosition(this._model.pointer());return this},move:function(h){var f=this;h=!!h;JC.log("HorizontalView move, is backwrad",h,this._model.pointer());var g=this._model.newpointer(h);JC.log(printf("is backwrad: {0}, pointer:{1}, new pointer:{2}",h,this._model.pointer(),g));this.moveTo(g)},moveTo:function(i){var f=this;if(!this._model.loop()){if(i<=this._model.pointer()&&this._model.pointer()===0){d(this._slider).trigger("outmin");return}if(i>=this._model.pointer()&&this._model.pointer()>=this._model.totalpage()-1){d(this._slider).trigger("outmax");return}}i=this._model.fixpointer(i);var k=this._model.pointer();if(i===k){return}var j=this._model.page(k),h=this._model.page(i);var g=j.concat(h);this._setNewPagePosition(j,h,k,i);f._model.pointer(i)},_setNewPagePosition:function(m,i,l,k){var g=this,f,h=m.concat(i),j;d(this._slider).trigger("cleartinterval");if(l<k){f=this._model.width()+this._itemspace}else{f=-(this._model.width()+this._itemspace);j=true}l===(g._model.totalpage()-1)&&k===0&&(f=this._model.width()+this._itemspace,j=false);l===0&&k===(g._model.totalpage()-1)&&(f=-(this._model.width()+this._itemspace),j=true);d.each(i,function(p,o){var n=d(o);n.css({left:f+g._model.itemwidth()*p+g._itemspace*p+"px"});n.show()});d(g._slider).trigger("beforemove",[l,k]);d.each(h,function(o,n){n.data("TMP_LEFT",n.prop("offsetLeft"))});JC.log("zzzzzzzzzz",f,this._itemspace,this._model.moveDirection());g._model.interval(easyEffect(function(n,o){d(h).each(function(q,p){p.css({left:p.data("TMP_LEFT")+(j?n:-n)+"px"})});if(o){d(m).each(function(q,p){p.hide()});d(g._slider).trigger("movedone",[l,k]);g._model.pointer(k);g.setPagePosition()}},this._model.width(),0,this._model.durationms(),this._model.stepms()))},setPagePosition:function(k){JC.log("view setPagePosition",new Date().getTime());typeof k=="undefined"&&(k=this._model.pointer());this._model.subitems().hide();var h=this._model.page(k);for(var g=0,f=h.length;g<f;g++){h[g].css({left:g*this._model.itemwidth()+g*this._itemspace+"px"}).show()}JC.log(h.length)}};function a(f,g){this._model=f;this._slider=g;this._itemspace=0;this._init()}a.prototype={_init:function(){this.setPagePosition(this._model.pointer());return this},move:function(g){var f=this;return this},moveTo:function(g){var f=this;return this},_setNewPagePosition:function(m,i,l,k){var g=this,f,h=m.concat(i),j;return this},setPagePosition:function(g){var f=this;JC.log("view setPagePosition",new Date().getTime());return this}};d(document).ready(function(){if(!c.autoInit){return}c.init(document.body)})}(jQuery));