(function(f){window.Calendar=JC.Calendar=g;function g(b){if(g.getInstance(b)){return g.getInstance(b)}g.getInstance(b,this);var a=g.type(b);JC.log("Calendar init:",a,new Date().getTime());switch(a){case"week":this._model=new g.WeekModel(b);this._view=new g.WeekView(this._model);break;case"month":this._model=new g.MonthModel(b);this._view=new g.MonthView(this._model);break;case"season":this._model=new g.SeasonModel(b);this._view=new g.SeasonView(this._model);break;case"monthday":this._model=new g.MonthDayModel(b);this._view=new g.MonthDayView(this._model);break;default:this._model=new g.Model(b);this._view=new g.View(this._model);break}this._init()}g.prototype={_init:function(){var a=this;a._initHanlderEvent();f([a._view,a._model]).on("BindEvent",function(d,b,c){a.on(b,c)});f([a._view,a._model]).on("TriggerEvent",function(d,b){var c=sliceArgs(arguments).slice(2);a.trigger(b,c)});a._model.init();a._view.init();return a},_initHanlderEvent:function(){var a=this;a.on(g.Model.INITED,function(b){a._model.calendarinited()&&a._model.calendarinited().call(a._model.selector(),a._model.layout(),a)});a.on(g.Model.SHOW,function(b){a._model.calendarshow()&&a._model.calendarshow().call(a._model.selector(),a._model.selector(),a)});a.on(g.Model.HIDE,function(b){a._model.calendarhide()&&a._model.calendarhide().call(a._model.selector(),a._model.selector(),a)});a.on(g.Model.UPDATE,function(z){if(!a._model.selector()){return}a._model.selector().blur();a._model.selector().trigger("change");var x=[],b=a._model.selector().val().trim(),y,u,s,d,t,c;if(b){s=b.split(",");for(var v=0,w=s.length;v<w;v++){d=s[v].replace(/[^\d]/g,"");if(d.length==16){t=parseISODate(d.slice(0,8));c=parseISODate(d.slice(8))}else{if(d.length==8){t=parseISODate(d.slice(0,8));c=cloneDate(t)}}if(v===0){y=cloneDate(t);u=cloneDate(c)}x.push({start:t,end:c})}}a._model.calendarupdate()&&a._model.calendarupdate().apply(a._model.selector(),[y,u]);a._model.multiselect()&&a._model.calendarupdatemultiselect()&&a._model.calendarupdatemultiselect().call(a._model.selector(),x,a)});a.on(g.Model.CLEAR,function(b){a._model.calendarclear()&&a._model.calendarclear().call(a._model.selector(),a._model.selector(),a)});a.on(g.Model.CANCEL,function(b){a._model.calendarcancel()&&a._model.calendarcancel().call(a._model.selector(),a._model.selector(),a)});a.on(g.Model.LAYOUT_CHANGE,function(b){a._model.calendarlayoutchange()&&a._model.calendarlayoutchange().call(a._model.selector(),a._model.selector(),a)});a.on(g.Model.UPDATE_MULTISELECT,function(b){a._model.multiselect()&&a._model.calendarupdatemultiselect()&&a._model.calendarupdatemultiselect().call(a._model.selector(),a._model.selector(),a)});return a},show:function(){g.hide();g.lastIpt=this._model.selector();this._view.show();this.trigger(g.Model.SHOW);return this},hide:function(){this._view.hide();this.trigger(g.Model.HIDE);this.selector()&&this.selector().blur();return this},selector:function(){return this._model.selector()},layout:function(){return this._model.layout()},on:function(a,b){f(this).on(a,b);return this},trigger:function(a,b){f(this).trigger(a,b);return this},updateLayout:function(){this._view.updateLayout();return this},updateSelector:function(a){g.lastIpt=a;this._model&&this._model.selector(a);return this},updateYear:function(a){this._view&&this._view.updateYear(a);this.trigger(g.Model.LAYOUT_CHANGE);return this},updateMonth:function(a){this._view&&this._view.updateMonth(a);this.trigger(g.Model.LAYOUT_CHANGE);return this},updateSelected:function(a){JC.log("JC.Calendar: updateSelector",new Date().getTime());this._view&&this._view.updateSelected(a);return this},updatePosition:function(){this._view&&this._view.updatePosition();return this},clear:function(){var a=!this._model.selector().val().trim();this._model&&this._model.selector().val("");!a&&this.trigger(g.Model.CLEAR);return this},cancel:function(){this.trigger(g.Model.CANCEL);this._view&&this._view.hide();return this},visible:function(){var a,b;this._model&&(b=this._model.layout())&&(a=b.is(":visible"));return a},defaultDate:function(a){return this._model.defaultDate(a)}};g.getInstance=function(c,a){typeof c=="string"&&!/</.test(c)&&(c=f(c));if(!(c&&c.length)||(typeof c=="string")){return}var b=g.type(c);typeof a!="undefined"&&(g._ins[b]=a);g._ins[b]&&g._ins[b].updateSelector(c);return g._ins[b]};g._ins={};g.type=function(c){c=f(c);var a,b=f.trim(c.attr("multidate")||"").toLowerCase()||f.trim(c.attr("datatype")||"").toLowerCase();switch(b){case"week":case"month":case"season":case"monthday":a=b;break;default:a="date";break}return a};g.isCalendar=function(b){b=f(b);var a=0;if(b.length){if(b.hasClass("UXCCalendar_btn")){a=1}if(b.prop("nodeName")&&b.attr("datatype")&&(b.prop("nodeName").toLowerCase()=="input"||b.prop("nodeName").toLowerCase()=="button")&&(b.attr("datatype").toLowerCase()=="date"||b.attr("datatype").toLowerCase()=="week"||b.attr("datatype").toLowerCase()=="month"||b.attr("datatype").toLowerCase()=="season"||b.attr("datatype").toLowerCase()=="year"||b.attr("datatype").toLowerCase()=="daterange"||b.attr("datatype").toLowerCase()=="monthday")){a=1}if(b.prop("nodeName")&&b.attr("multidate")&&(b.prop("nodeName").toLowerCase()=="input"||b.prop("nodeName").toLowerCase()=="button")){a=1}}return a};g.isCalendarElement=function(a){return g.isCalendar(a)};g.pickDate=function(c){c=f(c);if(!(c&&c.length)){return}var b,a=c.is("[ignoreprocess]");c.attr("ignoreprocess",true);c.blur();!a&&c.removeAttr("ignoreprocess");b=g.getInstance(c);!b&&(b=new g(c));b.show();return};g.autoInit=true;g.defaultDateSpan=20;g.lastIpt=null;g.tpl="";g.layoutInitedCallback=null;g.layoutShowCallback=null;g.layoutHideCallback=null;g.domClickFilter=null;g.hide=function(){for(var a in g._ins){g._ins[a]&&g._ins[a].visible()&&g._ins[a].hide()}};g.getDate=function(a){return g.getInstance(a).defaultDate()};g.cnWeek="日一二三四五六";g.cnUnit="十一二三四五六七八九";g.getCnNum=function(b){var a=g.cnUnit.charAt(b%10);b>10&&(a=(b%10!==0?g.cnUnit.charAt(0):"")+a);b>19&&(a=g.cnUnit.charAt(Math.floor(b/10))+a);return a};g.position=function(a){g.getInstance(a)&&g.getInstance(a).updatePosition()};g.setPosition=g.position;g.initTrigger=function(a){a.each(function(){var m=f(this),n=(m.prop("nodeName")||"").toLowerCase(),c;if(n!="input"&&n!="textarea"){g.initTrigger(a.find("input[type=text], textarea"));return}if(!(f.trim(m.attr("datatype")||"").toLowerCase()=="date"||f.trim(m.attr("multidate")||"")||f.trim(m.attr("datatype")||"").toLowerCase()=="daterange"||f.trim(m.attr("datatype")||"").toLowerCase()=="monthday")){return}var d=m.find("+ input.UXCCalendar_btn");if(!d.length){m.after(d=f('<input type="button" class="UXCCalendar_btn"  />'))}(c=m.val().trim())&&(c=dateDetect(c))&&m.val(formatISODate(c));(c=(m.attr("minvalue")||""))&&(c=dateDetect(c))&&m.attr("minvalue",formatISODate(c));(c=(m.attr("maxvalue")||""))&&(c=dateDetect(c))&&m.attr("maxvalue",formatISODate(c));if((m.attr("datatype")||"").toLowerCase()=="monthday"||(m.attr("multidate")||"").toLowerCase()=="monthday"){if(!m.is("[placeholder]")){var b=new Date();m.attr("defaultdate")&&(b=parseISODate(m.attr("defaultdate"))||b);m.val().trim()&&(b=parseISODate(m.val().replace(/[^d]/g,"").slice(0,8))||b);b&&m.attr("placeholder",printf("{0}年 {1}月",b.getFullYear(),b.getMonth()+1))}}d.data(g.Model.INPUT,m)})};g.updateMultiYear=function(c,b){var a,d;a=c.getDate();c.setDate(1);c.setFullYear(c.getFullYear()+b);d=maxDayOfMonth(c);a>d&&(a=d);c.setDate(a);return c};g.updateMultiMonth=function(c,b){var a,d;a=c.getDate();c.setDate(1);c.setMonth(c.getMonth()+b);d=maxDayOfMonth(c);a>d&&(a=d);c.setDate(a);return c};g.clone=function(b,a){var c;if(b){for(c in h.prototype){b.prototype[c]=h.prototype[c]}}if(a){for(c in e.prototype){a.prototype[c]=e.prototype[c]}}};function h(a){this._selector=a}g.Model=h;g.Model.INPUT="CalendarInput";g.Model.INITED="CalendarInited";g.Model.SHOW="CalendarShow";g.Model.HIDE="CalendarHide";g.Model.UPDATE="CalendarUpdate";g.Model.CLEAR="CalendarClear";g.Model.CANCEL="CalendarCancel";g.Model.LAYOUT_CHANGE="CalendarLayoutChange";g.Model.UPDATE_MULTISELECT="CalendarUpdateMultiSelect";h.prototype={init:function(){return this},selector:function(a){typeof a!="undefined"&&(this._selector=a);return this._selector},layout:function(){var a=f("#UXCCalendar");if(!a.length){a=f(g.tpl||this.tpl).hide();a.attr("id","UXCCalendar").hide().appendTo(document.body);var b=f(['<option value="0">一月</option>','<option value="1">二月</option>','<option value="2">三月</option>','<option value="3">四月</option>','<option value="4">五月</option>','<option value="5">六月</option>','<option value="6">七月</option>','<option value="7">八月</option>','<option value="8">九月</option>','<option value="9">十月</option>','<option value="10">十一月</option>','<option value="11">十二月</option>'].join("")).appendTo(a.find("select.UMonth"))}return a},startYear:function(b){var c=g.defaultDateSpan,a=b.date.getFullYear();this.selector().is("[calendardatespan]")&&(c=parseInt(this.selector().attr("calendardatespan"),10));return a-c},endYear:function(b){var c=g.defaultDateSpan,a=b.date.getFullYear();this.selector().is("[calendardatespan]")&&(c=parseInt(this.selector().attr("calendardatespan"),10));return a+c},currentcanselect:function(){var a=true;this.selector().is("[currentcanselect]")&&(currentcanselect=parseBool(this.selector().attr("currentcanselect")));return a},year:function(){return parseInt(this.layout().find("select.UYear").val(),10)||1},month:function(){return parseInt(this.layout().find("select.UMonth").val(),10)||0},day:function(){var a,b=new Date();a=this.layout().find("td.cur > a[date], td.cur > a[dstart]");if(a.length){b.setTime(a.attr("date")||a.attr("dstart"))}JC.log("dddddd",b.getDate());return b.getDate()},defaultDate:function(){var b=this,a={date:null,minvalue:null,maxvalue:null,enddate:null,multidate:null};b.selector()&&(a=b.multiselect()?b.defaultMultiselectDate(a):b.defaultSingleSelectDate(a));a.minvalue=parseISODate(b.selector().attr("minvalue"));a.maxvalue=parseISODate(b.selector().attr("maxvalue"));return a},defaultSingleSelectDate:function(a){var d=this,c=d.selector(),b;if(b=parseISODate(c.val())){a.date=b}else{if(c.val()&&(b=c.val().replace(/[^\d]/g,"")).length==16){a.date=parseISODate(b.slice(0,8));a.enddate=parseISODate(b.slice(8))}else{b=new Date();if(g.lastIpt&&g.lastIpt.is("[defaultdate]")){b=parseISODate(g.lastIpt.attr("defaultdate"))||b}a.date=new Date(b.getFullYear(),b.getMonth(),b.getDate())}}return a},defaultMultiselectDate:function(a){var p=this,o=g.lastIpt,c,n,d,b;if(o.val()){c=o.val().trim().replace(/[^\d,]/g,"").split(",");n=[];f.each(c,function(k,l){if(l.length==16){d=parseISODate(l.slice(0,8));b=parseISODate(l.slice(8));if(!k){a.date=cloneDate(d);a.enddate=cloneDate(b)}n.push({start:d,end:b})}else{if(l.length==8){d=parseISODate(l.slice(0,8));b=cloneDate(d);if(!k){a.date=cloneDate(d);a.enddate=cloneDate(b)}n.push({start:d,end:b})}}});a.multidate=n}else{c=new Date();if(g.lastIpt&&g.lastIpt.is("[defaultdate]")){c=parseISODate(g.lastIpt.attr("defaultdate"))||c}a.date=new Date(c.getFullYear(),c.getMonth(),c.getDate());a.enddate=cloneDate(a.date);a.enddate.setDate(maxDayOfMonth(a.enddate));a.multidate=[];a.multidate.push({start:cloneDate(a.date),end:cloneDate(a.enddate)})}return a},layoutDate:function(){return this.multiselect()?this.multiLayoutDate():this.singleLayoutDate()},singleLayoutDate:function(){var d=this,a=d.defaultDate(),b=this.day(),c;a.date.setDate(1);a.date.setFullYear(this.year());a.date.setMonth(this.month());c=maxDayOfMonth(a.date);b>c&&(b=c);a.date.setDate(b);return a},multiLayoutDate:function(){JC.log("Calendar.Model multiLayoutDate",new Date().getTime());var l=this,a=l.defaultDate(),b=l.year(),c=l.month(),d=l.layout().find("select.UMonth");a.multidate=[];l.layout().find("td.cur").each(function(){var p=f(this);var r=p.find("> a[dstart]"),k=new Date(),q=new Date();k.setTime(r.attr("dstart"));q.setTime(r.attr("dend"));a.multidate.push({start:k,end:q})});a.date.setFullYear(b);a.enddate.setFullYear(b);if(d.length){a.date.setMonth(c);a.enddate.setMonth(c)}f.each(a.multidate,function(k,n){n.start.setFullYear(b);n.end.setFullYear(b);if(d.length){n.start.setMonth(c);n.end.setMonth(c)}});return a},selectedDate:function(){var a,b,c;b=this.layout().find("td.cur");b.length&&!b.hasClass("unable")&&(c=b.find("a[date]"))&&(a=new Date(),a.setTime(c.attr("date")));return a},multiselectDate:function(){var a=[];return a},calendarinited:function(){var a=this.selector(),b=g.layoutInitedCallback,c;a&&a.attr("calendarinited")&&(c=window[a.attr("calendarinited")])&&(b=c);return b},calendarshow:function(){var a=this.selector(),b=g.layoutShowCallback,c;a&&a.attr("calendarshow")&&(c=window[a.attr("calendarshow")])&&(b=c);return b},calendarhide:function(){var a=this.selector(),b=g.layoutHideCallback,c;a&&a.attr("calendarhide")&&(c=window[a.attr("calendarhide")])&&(b=c);return b},calendarupdate:function(b){var a=this.selector(),c,d;a&&a.attr("calendarupdate")&&(d=window[a.attr("calendarupdate")])&&(c=d);return c},calendarclear:function(){var a=this.selector(),b,c;a&&a.attr("calendarclear")&&(c=window[a.attr("calendarclear")])&&(b=c);return b},calendarcancel:function(){var a=this.selector(),b,c;a&&a.attr("calendarcancel")&&(c=window[a.attr("calendarcancel")])&&(b=c);return b},calendarlayoutchange:function(){var a=this.selector(),b,c;a&&a.attr("calendarlayoutchange")&&(c=window[a.attr("calendarlayoutchange")])&&(b=c);return b},multiselect:function(){var a;this.selector().is("[multiselect]")&&(a=parseBool(this.selector().attr("multiselect")));return a},calendarupdatemultiselect:function(b){var a=this.selector(),c,d;a&&a.attr("calendarupdatemultiselect")&&(d=window[a.attr("calendarupdatemultiselect")])&&(c=d);return c},tpl:['<div id="UXCCalendar" class="UXCCalendar">','    <div class="UHeader">','        <select class="UYear"></select>','        <img class="UImg yearctl" align="absMiddle" usemap="#UXCCalendar_Year" />','        <map name="UXCCalendar_Year"><area shape="rect" coords="0,0,13,8" href="#" action="up"><area shape="rect" coords="0,10,13,17" href="#" action="down"></map>','        <select class="UMonth"></select>','        <img class="UImg monthctl" align="absMiddle" usemap="#UXCCalendar_Month"  />','        <map name="UXCCalendar_Month"><area shape="rect" coords="0,0,13,8" href="#" action="up"><area shape="rect" coords="0,10,13,17" href="#" action="down"></map>',"    </div>",'    <table class="UTable">',"        <thead>","            <tr>","                <th>一</th>","                <th>二</th>","                <th>三</th>","                <th>四</th>","                <th>五</th>","                <th>六</th>","                <th>日</th>","            </tr>","        </thead>","   </table>",'   <table class="UTable UTableBorder">',"        <tbody>","           <!--<tr>",'                <td class="cur"><a href="#">2</a></td>','                <td class="unable"><a href="#">2</a></td>','                <td class="weekend cur"><a href="#">6</a></td>','                <td class="weekend hover"><a href="#">13</a></td>','                <td class="weekend other"><a href="#">41</a></td>','                <td class="weekend other"><a href="#">42</a></td>',"            </tr>-->","        </tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("")};function e(a){this._model=a}g.View=e;e.prototype={init:function(){return this},hide:function(){this._model.layout().hide()},show:function(){var a=this._model.defaultDate();JC.log("Calendar.View: show",new Date().getTime(),formatISODate(a.date));this._buildLayout(a);this._buildDone()},updateLayout:function(a){typeof a=="undefined"&&(a=this._model.layoutDate());this._buildLayout(a);this._buildDone()},updateYear:function(a){if(typeof a=="undefined"||a==0){return}this._model.multiselect()?this.updateMultiYear(a):this.updateSingleYear(a)},updateSingleYear:function(c){var a=this._model.layoutDate(),b=a.date.getDate(),d;a.date.setDate(1);a.date.setFullYear(a.date.getFullYear()+c);d=maxDayOfMonth(a.date);b>d&&(b=d);a.date.setDate(b);this._buildLayout(a);this._buildDone()},updateMultiYear:function(c){var a=this._model.layoutDate(),b,d;JC.Calendar.updateMultiYear(a.date,c);JC.Calendar.updateMultiYear(a.enddate,c);if(a.multidate){f.each(a.multidate,function(m,n){JC.Calendar.updateMultiYear(n.start,c);JC.Calendar.updateMultiYear(n.end,c)})}this._buildLayout(a);this._buildDone()},updateMonth:function(a){if(typeof a=="undefined"||a==0){return}this._model.multiselect()?this.updateMultiMonth(a):this.updateSingleMonth(a)},updateMultiMonth:function(c){var a=this._model.layoutDate(),b,d;JC.Calendar.updateMultiMonth(a.date,c);JC.Calendar.updateMultiMonth(a.enddate,c);if(a.multidate){f.each(a.multidate,function(m,n){JC.Calendar.updateMultiMonth(n.start,c);JC.Calendar.updateMultiMonth(n.end,c)})}this._buildLayout(a);this._buildDone()},updateSingleMonth:function(c){var a=this._model.layoutDate(),b=a.date.getDate(),d;a.date.setDate(1);a.date.setMonth(a.date.getMonth()+c);d=maxDayOfMonth(a.date);b>d&&(b=d);a.date.setDate(b);this._buildLayout(a);this._buildDone()},updateSelected:function(a){var d=this,c,b;if(!a){c=this._model.selectedDate()}else{a=f(a);b=getJqParent(a,"td");if(b&&b.hasClass("unable")){return}c=new Date();c.setTime(a.attr("date"))}if(!c){return}d._model.selector().val(formatISODate(c));f(d).trigger("TriggerEvent",[JC.Calendar.Model.UPDATE,"date",c,c]);g.hide()},updatePosition:function(){var y=this,A=y._model.selector(),B=y._model.layout();if(!(A&&B&&A.length&&B.length)){return}B.css({left:"-9999px",top:"-9999px","z-index":ZINDEX_COUNT++}).show();var b=B.width(),w=B.height(),a=A.width(),v=A.height(),c=A.offset(),d,u,z=f(window).width(),t=f(window).height(),x=f(document).scrollTop();d=c.left;u=c.top+v+5;if((u+w-x)>t){JC.log("y overflow");u=c.top-w-3;if(u<x){u=x}}B.css({left:d+"px",top:u+"px"});JC.log(b,w,a,v,c.left,c.top,z,t);JC.log(x,d,u)},_buildDone:function(){this.updatePosition();f(this).trigger("TriggerEvent",[g.Model.INITED])},_buildLayout:function(a){this._model.layout();if(!(a&&a.date)){return}this._buildHeader(a);this._buildBody(a);this._buildFooter(a)},_buildHeader:function(q){var s=this,a=s._model.layout(),t=[],c,p=p=q.date.getFullYear(),d=s._model.startYear(q),b=s._model.endYear(q);JC.log(d,b);for(var r=d;r<=b;r++){t.push(printf('<option value="{0}"{1}>{0}</option>',r,r===p?" selected":""))}f(t.join("")).appendTo(a.find("select.UYear").html(""));f(a.find("select.UMonth").val(q.date.getMonth()))},_buildBody:function(w){var B=this,E=B._model.layout();var F=maxDayOfMonth(w.date),c=w.date.getDay()||7,G=c+F,z=6,C=[],A,D,a,x,d;var y=new Date(w.date.getFullYear(),w.date.getMonth(),1);var b=y.getDay()||7;if(b<2){y.setDate(-(b-1+6))}else{y.setDate(-(b-2))}var H=new Date();if(w.maxvalue&&!B._model.currentcanselect()){w.maxvalue.setDate(w.maxvalue.getDate()-1)}C.push("<tr>");for(x=1;x<=42;x++){d=[];if(y.getDay()===0||y.getDay()==6){d.push("weekend")}if(!isSameMonth(w.date,y)){d.push("other")}if(w.minvalue&&y.getTime()<w.minvalue.getTime()){d.push("unable")}if(w.maxvalue&&y.getTime()>w.maxvalue.getTime()){d.push("unable")}if(isSameDay(y,H)){d.push("today")}if(isSameDay(w.date,y)){d.push("cur")}C.push('<td class="',d.join(" "),'">','<a href="javascript:" date="',y.getTime(),'" title="'+formatISODate(y)+'" >',y.getDate(),"</a></td>");y.setDate(y.getDate()+1);if(x%7===0&&x!=42){C.push("</tr><tr>")}}C.push("</tr>");E.find("table.UTableBorder tbody").html(f(C.join("")))},_buildFooter:function(a){}};f(document).delegate("body > div.UXCCalendar select.UYear, body > div.UXCCalendar select.UMonth","change",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateLayout()});f(document).delegate("body > div.UXCCalendar button.UNextYear","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateYear(1)});f(document).delegate("body > div.UXCCalendar button.UPreYear","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateYear(-1)});f(document).delegate("map[name=UXCCalendar_Year] area","click",function(b){b.preventDefault();var c=f(this),a=g.getInstance(g.lastIpt);c.attr("action")&&a&&(c.attr("action").toLowerCase()=="up"&&a.updateYear(1),c.attr("action").toLowerCase()=="down"&&a.updateYear(-1))});f(document).delegate("map[name=UXCCalendar_Month] area","click",function(b){b.preventDefault();var c=f(this),a=g.getInstance(g.lastIpt);c.attr("action")&&a&&(c.attr("action").toLowerCase()=="up"&&a.updateMonth(1),c.attr("action").toLowerCase()=="down"&&a.updateMonth(-1))});f(document).delegate("body > div.UXCCalendar button.UNextMonth","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateMonth(1)});f(document).delegate("body > div.UXCCalendar button.UPreMonth","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateMonth(-1)});f(document).delegate("div.UXCCalendar table a[date], div.UXCCalendar table a[dstart]","click",function(a){a.preventDefault();g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateSelected(f(this))});f(document).delegate("body > div.UXCCalendar button.UConfirm","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).updateSelected()});f(document).delegate("body > div.UXCCalendar button.UClear","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).clear()});f(document).delegate("body > div.UXCCalendar button.UCancel","click",function(a){g.getInstance(g.lastIpt)&&g.getInstance(g.lastIpt).cancel()});f(document).delegate("input.UXCCalendar_btn","click",function(b){var c=f(this),a;if(!c.data(g.Model.INPUT)){a=c.prev("input[type=text], textarea");a.length&&c.data(g.Model.INPUT,a)}c.data(g.Model.INPUT)&&!c.data(g.Model.INPUT).is("[disabled]")&&g.pickDate(c.data(g.Model.INPUT))});f(document).delegate("body > div.UXCCalendar","click",function(a){a.stopPropagation()});f(document).ready(function(b){setTimeout(function(c){if(!g.autoInit){return}g.initTrigger(f(document))},200);f(window).on("scroll resize",function(d){var c=g.getInstance(g.lastIpt);c&&c.visible()&&c.updatePosition()});var a=null;f(document).on("click",function(d){var c=d.target||d.srcElement;if(g.domClickFilter){if(g.domClickFilter(f(c))===false){return}}if(g.isCalendar(d.target||d.targetElement)){return}if(c&&(c.nodeName.toLowerCase()!="input"&&c.nodeName.toLowerCase()!="button"&&c.nodeName.toLowerCase()!="textarea")){g.hide();return}a&&clearTimeout(a);a=setTimeout(function(){if(g.lastIpt&&g.lastIpt.length&&c==g.lastIpt[0]){return}g.hide()},100)})});f(document).delegate(["input[datatype=season]","input[datatype=month]","input[datatype=week]","input[datatype=date]","input[datatype=daterange]","input[multidate], input[datatype=monthday]"].join(),"focus",function(a){g.pickDate(this)});f(document).delegate(["button[datatype=season]","button[datatype=month]","button[datatype=week]","button[datatype=date]","button[datatype=daterange]","button[multidate], button[datatype=monthday]"].join(),"click",function(a){g.pickDate(this)});f(document).delegate(["textarea[datatype=season]","textarea[datatype=month]","textarea[datatype=week]","textarea[datatype=date]","textarea[datatype=daterange]","textarea[multidate], textarea[datatype=monthday]"].join(),"click",function(a){g.pickDate(this)})}(jQuery));(function(g){JC.Calendar.weekTpl="";JC.Calendar.weekDayOffset=1;function e(a){this._selector=a}JC.Calendar.WeekModel=e;function f(a){this._model=a}JC.Calendar.WeekView=f;JC.Calendar.clone(e,f);e.prototype.layout=function(){var a=g("#UXCCalendar_week");if(!a.length){a=g(JC.Calendar.weekTpl||this.tpl).hide();a.attr("id","UXCCalendar_week").hide().appendTo(document.body)}return a};e.prototype.tpl=['<div id="UXCCalendar_week" class="UXCCalendar UXCCalendar_week" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("");e.prototype.month=function(){var a=0,b,c=new Date();(b=this.layout().find("td.cur a[dstart]")).length&&(c=new Date())&&(c.setTime(b.attr("dstart")));a=c.getMonth();return a};e.prototype.selectedDate=function(){var a,b,c;b=this.layout().find("td.cur");b.length&&!b.hasClass("unable")&&(c=b.find("a[dstart]"))&&(a={start:new Date(),end:new Date()},a.start.setTime(c.attr("dstart")),a.end.setTime(c.attr("dend")));return a};e.prototype.singleLayoutDate=function(){var d=this,a=d.defaultDate(),b=this.day(),c,l=d.layout().find("td.cur > a[week]");a.date.setDate(1);a.date.setFullYear(this.year());a.date.setMonth(this.month());c=maxDayOfMonth(a.date);b>c&&(b=c);a.date.setDate(b);l.length&&(a.curweek=parseInt(l.attr("week"),10));JC.log("WeekModel.singleLayoutDate:",l.length,a.curweek);return a};f.prototype._buildBody=function(c){var a=this,F=c.date,J=a._model.layout(),z=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()).getTime(),I=h(F.getFullYear(),JC.Calendar.weekDayOffset),A=h(F.getFullYear()+1,JC.Calendar.weekDayOffset),H=0,d=[],L,D,E,G,B,K=F.getFullYear(),M=Math.ceil(I.length/8),C=JC.Calendar.lastIpt,N=parseBool(C.attr("currentcanselect"));if(c.maxvalue&&N){var b=c.maxvalue.getDay();if(b>0){c.maxvalue.setDate(c.maxvalue.getDate()+(7-b))}}d.push("<tr>");for(i=1,j=M*8;i<=j;i++){D=I[i-1];if(!D){D=A[H++];K=F.getFullYear()+1}G=new Date();B=new Date();G.setTime(D.start);B.setTime(D.end);E=printf("{0}年 第{1}周\n开始日期: {2} (周{4})\n结束日期: {3} (周{5})",K,JC.Calendar.getCnNum(D.week),formatISODate(G),formatISODate(B),JC.Calendar.cnWeek.charAt(G.getDay()%7),JC.Calendar.cnWeek.charAt(B.getDay()%7));L=[];if(c.minvalue&&G.getTime()<c.minvalue.getTime()){L.push("unable")}if(c.maxvalue&&B.getTime()>c.maxvalue.getTime()){L.push("unable")}if(c.curweek){if(D.week==c.curweek&&F.getFullYear()==G.getFullYear()){L.push("cur")}}else{if(F.getTime()>=G.getTime()&&F.getTime()<=B.getTime()){L.push("cur")}}if(z>=G.getTime()&&z<=B.getTime()){L.push("today")}d.push(printf('<td class="{0}"><a href="javascript:" title="{2}" dstart="{3}" dend="{4}" week="{1}" date="{5}" >{1}</a></td>',L.join(" "),D.week,E,G.getTime(),B.getTime(),c.date.getTime()));if(i%8===0&&i!=j){d.push("</tr><tr>")}}d.push("</tr>");J.find("table.UTableBorder tbody").html(g(d.join("")))};f.prototype.updateSelected=function(a){var l=this,d,b,c;if(!a){c=this._model.selectedDate();c&&(d=c.start,b=c.end)}else{a=g(a);c=getJqParent(a,"td");if(c&&c.hasClass("unable")){return}d=new Date();b=new Date();d.setTime(a.attr("dstart"));b.setTime(a.attr("dend"))}if(!(d&&b)){return}l._model.selector().val(printf("{0} 至 {1}",formatISODate(d),formatISODate(b)));g(l).trigger("TriggerEvent",[JC.Calendar.Model.UPDATE,"week",d,b]);JC.Calendar.hide()};function h(c,d){var a=[],b,m=1,d=d||0,c=parseInt(c,10),n=new Date(c,0,1);n.getDay()>1&&n.setDate(n.getDate()-n.getDay()+7);d>0&&(d=(new Date(2000,1,2)-new Date(2000,1,1))*d);while(n.getFullYear()<=c){b={week:m++,start:null,end:null};b.start=n.getTime()+d;n.setDate(n.getDate()+6);b.end=n.getTime()+d;n.setDate(n.getDate()+1);if(n.getFullYear()>c){n=new Date(n.getFullYear(),0,1);if(n.getDay()<2){break}}a.push(b)}return a}}(jQuery));(function(d){JC.Calendar.monthTpl="";function e(a){this._selector=a}JC.Calendar.MonthModel=e;function f(a){this._model=a}JC.Calendar.MonthView=f;JC.Calendar.clone(e,f);e.prototype.layout=function(){var a=d("#UXCCalendar_month");if(!a.length){a=d(JC.Calendar.monthTpl||this.tpl).hide();a.attr("id","UXCCalendar_month").hide().appendTo(document.body)}return a};e.prototype.tpl=['<div id="UXCCalendar_month" class="UXCCalendar UXCCalendar_week UXCCalendar_month" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("");e.prototype.month=function(){var a=0,b,c;(b=this.layout().find("td.cur a[dstart]")).length&&(c=new Date())&&(c.setTime(b.attr("dstart")),a=c.getMonth());return a};e.prototype.selectedDate=function(){var a,b,c;b=this.layout().find("td.cur");b.length&&!b.hasClass("unable")&&(c=b.find("a[dstart]"))&&(a={start:new Date(),end:new Date()},a.start.setTime(c.attr("dstart")),a.end.setTime(c.attr("dend")));return a};f.prototype._buildBody=function(A){var E=this,G=A.date,H=E._model.layout(),w=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()).getTime(),z=0,F=[],y,D,J,C,I,B=G.getFullYear(),b=4,a=JC.Calendar.lastIpt,x=parseBool(a.attr("currentcanselect")),c=A.multidate?A.multidate.slice():null;if(A.maxvalue&&x){A.maxvalue.setDate(maxDayOfMonth(A.maxvalue))}F.push("<tr>");for(i=1,j=12;i<=j;i++){C=new Date(B,i-1,1);I=new Date(B,i-1,maxDayOfMonth(C));J=printf("{0}年 {1}月<br/>开始日期: {2} (周{4})<br />结束日期: {3} (周{5})",B,JC.Calendar.getCnNum(i),formatISODate(C),formatISODate(I),JC.Calendar.cnWeek.charAt(C.getDay()%7),JC.Calendar.cnWeek.charAt(I.getDay()%7));y=[];if(A.minvalue&&C.getTime()<A.minvalue.getTime()){y.push("unable")}if(A.maxvalue&&I.getTime()>A.maxvalue.getTime()){y.push("unable")}if(c){d.each(c,function(g,h){if(C.getTime()>=h.start.getTime()&&C.getTime()<=h.end.getTime()){y.push("cur");c.splice(g,1);return false}})}else{if(G.getTime()>=C.getTime()&&G.getTime()<=I.getTime()){y.push("cur")}}if(w>=C.getTime()&&w<=I.getTime()){y.push("today")}_cnUnit=JC.Calendar.cnUnit.charAt(i%10);i>10&&(_cnUnit="十"+_cnUnit);F.push(printf('<td class="{0}"><a href="javascript:" title="{1}" dstart="{3}" dend="{4}" month="{5}" >{2}月</a></td>',y.join(" "),J,_cnUnit,C.getTime(),I.getTime(),i));if(i%3===0&&i!=j){F.push("</tr><tr>")}}F.push("</tr>");H.find("table.UTableBorder tbody").html(d(F.join("")))};e.prototype.multiselectDate=function(){var n=this,a=[],m,c,l,b;n.layout().find("td.cur").each(function(){m=d(this);c=m.find("> a[dstart]");if(m.hasClass("unable")){return}l=new Date();b=new Date();l.setTime(c.attr("dstart"));b.setTime(c.attr("dend"));a.push({start:l,end:b})});return a};f.prototype.updateSelected=function(a){var p=this,o,b,n,c,m;if(!a){if(p._model.multiselect()){n=this._model.multiselectDate();if(!n.length){return}m=[];d.each(n,function(h,g){m.push(printf("{0} 至 {1}",formatISODate(g.start),formatISODate(g.end)))});c=m.join(",")}else{n=this._model.selectedDate();n&&(o=n.start,b=n.end);o&&b&&(c=printf("{0} 至 {1}",formatISODate(o),formatISODate(b)))}}else{a=d(a);n=getJqParent(a,"td");if(n&&n.hasClass("unable")){return}if(p._model.multiselect()){n.toggleClass("cur");return}o=new Date();b=new Date();o.setTime(a.attr("dstart"));b.setTime(a.attr("dend"));c=printf("{0} 至 {1}",formatISODate(o),formatISODate(b))}if(!c){return}p._model.selector().val(c);d(p).trigger("TriggerEvent",[JC.Calendar.Model.UPDATE,"month",o,b]);JC.Calendar.hide()}}(jQuery));(function(f){JC.Calendar.seasonTpl="";function d(a){this._selector=a}JC.Calendar.SeasonModel=d;function e(a){this._model=a}JC.Calendar.SeasonView=e;JC.Calendar.clone(d,e);d.prototype.layout=function(){var a=f("#UXCCalendar_season");if(!a.length){a=f(JC.Calendar.seasonTpl||this.tpl).hide();a.attr("id","UXCCalendar_season").hide().appendTo(document.body)}return a};d.prototype.tpl=['<div id="UXCCalendar_season" class="UXCCalendar UXCCalendar_week UXCCalendar_season" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("");d.prototype.month=function(){var a=0,b,c;(b=this.layout().find("td.cur a[dstart]")).length&&(c=new Date())&&(c.setTime(b.attr("dstart")),a=c.getMonth());return a};d.prototype.selectedDate=function(){var a,b,c;b=this.layout().find("td.cur");b.length&&!b.hasClass("unable")&&(c=b.find("a[dstart]"))&&(a={start:new Date(),end:new Date()},a.start.setTime(c.attr("dstart")),a.end.setTime(c.attr("dend")));return a};e.prototype._buildBody=function(b){var a=this,D=b.date,G=a._model.layout(),x=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()).getTime(),F=0,c=[],I,A,B,E,y,H=D.getFullYear(),J=4,z=JC.Calendar.lastIpt,L=parseBool(z.attr("currentcanselect"));if(b.maxvalue&&L){var K=b.maxvalue.getMonth()+1,C;if(K%3!==0){b.maxvalue.setDate(1);b.maxvalue.setMonth(K+(3-(K%3)-1))}b.maxvalue.setDate(maxDayOfMonth(b.maxvalue))}c.push("<tr>");for(i=1,j=4;i<=j;i++){E=new Date(H,i*3-3,1);y=new Date(H,i*3-1,1);y.setDate(maxDayOfMonth(y));_cnUnit=JC.Calendar.cnUnit.charAt(i%10);i>10&&(_cnUnit="十"+_cnUnit);B=printf("{0}年 第{1}季度<br/>开始日期: {2} (周{4})<br />结束日期: {3} (周{5})",H,JC.Calendar.getCnNum(i),formatISODate(E),formatISODate(y),JC.Calendar.cnWeek.charAt(E.getDay()%7),JC.Calendar.cnWeek.charAt(y.getDay()%7));I=[];if(b.minvalue&&E.getTime()<b.minvalue.getTime()){I.push("unable")}if(b.maxvalue&&y.getTime()>b.maxvalue.getTime()){I.push("unable")}if(D.getTime()>=E.getTime()&&D.getTime()<=y.getTime()){I.push("cur")}if(x>=E.getTime()&&x<=y.getTime()){I.push("today")}c.push(printf('<td class="{0}"><a href="javascript:" title="{1}" dstart="{3}" dend="{4}" month="{5}" >{2}季度</a></td>',I.join(" "),B,_cnUnit,E.getTime(),y.getTime(),i));if(i%2===0&&i!=j){c.push("</tr><tr>")}}c.push("</tr>");G.find("table.UTableBorder tbody").html(f(c.join("")))};e.prototype.updateSelected=function(a){var l=this,k,b,c;if(!a){c=this._model.selectedDate();c&&(k=c.start,b=c.end)}else{a=f(a);c=getJqParent(a,"td");if(c&&c.hasClass("unable")){return}k=new Date();b=new Date();k.setTime(a.attr("dstart"));b.setTime(a.attr("dend"))}if(!(k&&b)){return}l._model.selector().val(printf("{0} 至 {1}",formatISODate(k),formatISODate(b)));f(l).trigger("TriggerEvent",[JC.Calendar.Model.UPDATE,"season",k,b]);JC.Calendar.hide()}}(jQuery));(function(g){JC.Calendar.monthdayTpl="";JC.Calendar.monthdayHeadAppendText="";function h(a){this._selector=a}JC.Calendar.MonthDayModel=h;function e(a){this._model=a}JC.Calendar.MonthDayView=e;JC.Calendar.clone(h,e);e.prototype.init=function(){var a=this;g(a).on("MonthDayToggle",function(d,c){var b=a._model.findItemByTimestamp(c.attr("dstart"));if(b.atd.hasClass("unable")){return}b.input.prop("checked",b.atd.hasClass("cur"));a._model.fixCheckall()});g(a).on("MonthDayInputToggle",function(d,c){var b=a._model.findItemByTimestamp(c.attr("dstart"));if(!b.atd){g(a).trigger("MonthDayToggleAll",[c]);return}if(b.atd.hasClass("unable")){return}b.atd[b.input.prop("checked")?"addClass":"removeClass"]("cur");a._model.fixCheckall()});g(a).on("MonthDayToggleAll",function(l,b){var c=a._model.layout().find("a[dstart]"),d=b.prop("checked");if(!c.length){return}c.each(function(){var n=g(this),k=getJqParent(n,"td");if(k.hasClass("unable")){return}k[d?"addClass":"removeClass"]("cur");g(a).trigger("MonthDayToggle",[n])})});return this};h.prototype.fixCheckall=function(){var d=this,l,b,a=true,c;d._fixCheckAllTm&&clearTimeout(d._fixCheckAllTm);d._fixCheckAllTm=setTimeout(function(){b=d.layout().find("input.js_JCCalendarCheckbox[action=all]");l=d.layout().find("input.js_JCCalendarCheckbox[dstart]");l.each(function(){c=g(this);var k=d.findItemByTimestamp(c.attr("dstart"));if(k.atd.hasClass("unable")){return}if(!c.prop("checked")){return a=false}});b.prop("checked",a)},100)};h.prototype.findItemByTimestamp=function(b){var c=this,a={a:null,atd:null,atr:null,input:null,inputtr:null,tm:b};if(b){a.a=c.layout().find(printf("a[dstart={0}]",b));a.atd=getJqParent(a.a,"td");a.atr=getJqParent(a.a,"tr");a.input=c.layout().find(printf("input[dstart={0}]",b));a.inputtr=getJqParent(a.input,"tr")}return a};h.prototype.layout=function(){var a=g("#UXCCalendar_monthday");if(!a.length){a=g(printf(JC.Calendar.monthdayTpl||this.tpl,JC.Calendar.monthdayHeadAppendText)).hide();a.attr("id","UXCCalendar_monthday").hide().appendTo(document.body);var b=g(['<option value="0">一月</option>','<option value="1">二月</option>','<option value="2">三月</option>','<option value="3">四月</option>','<option value="4">五月</option>','<option value="5">六月</option>','<option value="6">七月</option>','<option value="7">八月</option>','<option value="8">九月</option>','<option value="9">十月</option>','<option value="10">十一月</option>','<option value="11">十二月</option>'].join("")).appendTo(a.find("select.UMonth"))}return a};h.prototype.tpl=['<div id="UXCCalendar_monthday" class="UXCCalendar UXCCalendar_week UXCCalendar_monthday" >','    <div class="UHeader">','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <button type="button" class="UButton UPreMonth">&nbsp;&nbsp;&lt;&nbsp;&nbsp;</button>','        <select class="UYear" style=""></select>','        <select class="UMonth"></select>',"        {0}",'        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UNextMonth">&nbsp;&nbsp;&gt;&nbsp;&nbsp;</button>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join("");h.prototype.multiselect=function(){return true};h.prototype.multiselectDate=function(){var l=this,a=[],c,b,d;l.layout().find("input.js_JCCalendarCheckbox[dstart]").each(function(){c=g(this);if(!c.prop("checked")){return}d=new Date();d.setTime(c.attr("dstart"));a.push(d)});return a};e.prototype.updateSelected=function(r){var q=this,o,a,d,b,c;if(!r){d=this._model.multiselectDate();if(!d.length){return}c=[];for(var p=0;p<d.length;p++){c.push(formatISODate(d[p]))}b=c.join(",")}else{r=g(r);d=getJqParent(r,"td");if(d&&d.hasClass("unable")){return}if(q._model.multiselect()){d.toggleClass("cur");return}_date=new Date();_date.setTime(r.attr("date"));b=r.attr("date");b=printf("{0}",formatISODate(_date))}if(!b){return}if(d.length){q._model.selector().attr("placeholder",printf("{0}年 {1}",d[0].getFullYear(),d[0].getMonth()+1));q._model.selector().attr("defaultdate",formatISODate(d[0]))}q._model.selector().val(b);g(q).trigger("TriggerEvent",[JC.Calendar.Model.UPDATE,"monthday",d]);JC.Calendar.hide()};h.prototype.fixedDate=function(b){var d=this,c=JC.Calendar.lastIpt,a;c&&!c.is("[defaultdate]")&&(a=cloneDate(b.multidate[0].start),c.attr("defaultdate",formatISODate(a)))};e.prototype._buildBody=function(x){var A=this,D=A._model.layout();var F=maxDayOfMonth(x.date),B=[],w,v,y,E,a=new Date();A._model.fixedDate(x);y=new Date(x.date.getFullYear(),x.date.getMonth(),1);E=y.getDay();var d=[],C=[],c=[];var z=[],b=[];d.push('<tr><td><span class="bold">星期</span></td>');C.push('<tr><td><span class="bold">日期</span></td>');c.push('<tr class="Uchkdate"><td><label><span class="bold">全选</span>&nbsp;<input type="checkbox" class="js_JCCalendarCheckbox" action="all"  /></lable></td>');for(w=0;w<F;w++){z=[];b=f(x,y,a).join(" ");if(E==0||E==6){z.push("red")}d.push(printf('<td class="{0}">{1}</td>',z.join(" "),Calendar.cnWeek[E]));C.push(printf('<td class="{0}"><a href="javascript:;" dstart="{1}" dend="{1}" title="{3}" >{2}</a></td>',b,y.getTime(),w+1,formatISODate(y)));c.push(printf('<td><input type="checkbox" date="{1}" dstart="{1}" dend="{1}" class="js_JCCalendarCheckbox" action="item" {3} {4} title="{2}" /></td>',"",y.getTime(),formatISODate(y),/\bcur\b/.test(b)?"checked":"",/\bunable\b/.test(b)?"disabled":""));y.setDate(y.getDate()+1);E=y.getDay()}d.push("</tr>");C.push("</tr>");c.push("</tr>");B=B.concat(d,C,c);D.find("table.UTableBorder tbody").html(g(B.join("")));A._model.fixCheckall()};function f(b,c,a){var n=[];if(b.minvalue){if(c.getTime()<b.minvalue.getTime()){n.push("unable")}}if(b.maxvalue){if(c.getTime()>b.maxvalue.getTime()){n.push("unable")}}if(isSameDay(c,a)){n.push("today")}for(var d=0,m=b.multidate.length;d<m;d++){if(isSameDay(b.multidate[d].start,c)){n.push("cur");break}}return n}g(document).delegate("#UXCCalendar_monthday a[dstart]","click",function(c){var d=JC.Calendar.lastIpt,b,a,l=g(this);if(!d){return}b=JC.Calendar.type(d);a=JC.Calendar.getInstance(d);if(!a){return}g(a._view).trigger("MonthDayToggle",[l])});g(document).delegate("#UXCCalendar_monthday input.js_JCCalendarCheckbox","click",function(c){var d=JC.Calendar.lastIpt,b,a,l=g(this);if(!d){return}b=JC.Calendar.type(d);a=JC.Calendar.getInstance(d);if(!a){return}g(a._view).trigger("MonthDayInputToggle",[l])})}(jQuery));